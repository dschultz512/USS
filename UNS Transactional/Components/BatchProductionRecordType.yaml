components:

  schemas:
    ProcessBatchProductionRecordType:
      type: object
      properties:
        '@releaseID':
          type: string
          examples:
            - 1.0.0
        '@versionID':
          type: string
        ApplicationArea:
          $ref: './CommonTypes.yaml#/components/schemas/TransApplicationAreaType'
        DataArea:
          type: object
          properties:
            Process:
              $ref: './CommonTypes.yaml#/components/schemas/TransProcessType'
            BatchProductionRecord:
              type: array
              minItems: 1
              items:
                $ref: '#/components/schemas/BatchProductionRecordEntryType'
          required:
            - Process
      required:
        - '@releaseID'
        - ApplicationArea
        - DataArea

    BatchProductionRecordEntryType:
      type: object
      properties:
        ID:
          type: string
          description: A unique identification of the BPR.
        EntryID:
          type: string
          description: A unique identification of the BPR individual element.
        ObjectType:
          type: string
          description: Identifies the type of object an entry is based upon. This may be either a standard type or an application specific extended type. If “Other” then the type is an application specific extension and the value is defined in the attribute “OtherValue”.
          enum: ["Batch Production Record","Change","Comment","Control Recipe","Data Set","Event","Master Recipe","Personnel Identification Manifest","Resource Definition Manifest","Recipe Element","Sample","Sample Test","Sample Test Result","Work Directive","Work Master","Work Performance","Work Schedule","Other"]
          example: "Batch Production Record"
        TimeStamp:
          type: string
          description: The optional time stamp associated with the entry.
          format: datetime
        ExternalReference:
          type: string
          description: Contains an optional reference to data which is stored external to the BPR.
        Description:
          type: array
          description: Additional optional additional information about the BPR.
          items:
            type: string
        EquipmentID:
          type: array
          items:
            type: string
            description: "Equipment hierarchy. Each item is optional, if not filled in the pipe will be empty. {Site}|{Area}|{Work Cell}|{Work Unit}|{Equipment Module}|{Control Module}"
        BatchID:
          type: string
          examples:
            - 1008108-50075-25APR2022OQ1-0080-202205212911
        Comments:
          type: object
          properties:
            Comment:
              type: array
              items:
                $ref: '#/components/schemas/CommentType'
        Events:
          $ref: '#/components/schemas/EventsType'
        PersonnelIdentification:
          type: object
          properties:
            PersonnelIdentificationManifest:
              type: array
              items:
                $ref: '#/components/schemas/PersonnelIdentificationManifestType'
      required:
        - ID
        - EntryID
        - ObjectType

    EventsType:
      type: object
      properties:
        Event:
          type: array
          items:
            $ref: '#/components/schemas/SingleEventType'
      example:
        - Eventtype: General
          EventSubType: State Change
          Value:
            DataType: String
            ValueString: RUNNING
          PersonID: 
          TimeStamp: 2022-05-02T16:09:20.127Z

    SingleEventType:
      type: object
      properties:
        EntryID:
          type: string
        ObjectType:
          type: string
          enum: ["Batch Production Record","Change","Comment","Control Recipe","Data Set","Event","Master Recipe","Personnel Identification Manifest","Resource Definition Manifest","Recipe Element","Sample","Sample Test","Sample Test Result","Work Directive","Work Master","Work Performance","Work Schedule","Other"]
          example: "Event"
        TimeStamp:
          type: string
          format: datetime
        ExternalReference:
          type: string
        Description:
          type: array
          items:
            type: string
        EventType:
          type: string
          enum: [Alarm, Control Recipe, Equipment, General, Material, Message, Operator, Procedural Execution, Other]
          description: Defines an event type. The associated meaning of the event type, subtype, value, and previous value are specified in ANSI/ISA 88.04 and IEC 61512-4. This may be either a standard type or an application specific extended type.  Standard enumerations correspond to the BPR element types.
        EventSubType:
          type: string
          enum: [Allocation,Application,Consume,Deallocation,Equipment,Message,Mode Change,Mode Command,Modification,Movement,Parameter Data,Process,Process Data,Produce,Prompt,Prompt Response,Property Value Change,Reconciliation,Security,State Change,State Command,Status Change,System,Target End Time,Target Start Time,Other]
          description: Defines an event subtype. The associated meaning of the event type, subtype, value, and previous value are specified in ANSI/ISA 88.04 and IEC 61512-4. This may be either a standard type or an application specific extended type.  Standard enumerations correspond to the BPR element type.
        EquipmentID:
          type: array
          items:
            type: string
            description: "Equipment hierarchy. Each item is optional, if not filled in the pipe will be empty. {Site}|{Area}|{Work Cell}|{Work Unit}|{Equipment Module}|{Control Module}"
            examples:
              - "Norwood|LARGE_SCALE|9812-LS_FREEZER|FTU-9812|MXR-8526|VLV-8526"
              - "|||FTU-9812|MXR-8526|VLV-8526"
        Value:
          type: array
          items:
            $ref: './CommonTypes.yaml#/components/schemas/ValueType'
        PreviousValue:
          type: array
          items:
            $ref: './CommonTypes.yaml#/components/schemas/ValueType'
        MessageText:
          type: array
          items:
            type: string
        PersonID:
          type: array
          items:
            type: string
        ComputerID:
          type: array
          items:
            type: string
        PhysicalAssetID:
          type: array
          items:
            type: string
        ProceduralElementReference:
          type: array
          items:
            type: string
        Category:
          type: array
          items:
            type: string
        AlarmData: 
          type: array
          items:
            $ref: '#/components/schemas/AlarmDataType'
        AssociatedEventID:
          type: array
          items:
            type: string
        UserAttribute:
          type: array
          items:
            $ref: '#/components/schemas/UserAttributeType' 
      required:
        - EntryID
        - ObjectType
        - EventType

    AlarmDataType:
      type: object
      properties:
        AlarmEvent:
          description: 'Defines the type of alarm event. Standard identifiers are not defined.  Examples: Detected, Acknowledged, and Cleared.'
          type: string
        AlarmType:
          description: 'Defines the type of alarm. Standard identifiers are not defined.  Examples: High, Deviation, Rate of Change.'
          type: string
        AlarmLimit:
          description: 'Defines the value measurement that caused the alarm event.'
          type: array
          items:
            $ref: './CommonTypes.yaml#/components/schemas/ValueType'
        Priority:
          description: 'Defines the importance of the event.  Standard identifiers are not defined.  Examples: High, Low, 10, 9,8, 0 …'
          type: array
          items:
            type: string  
      required:
        - AlarmEvent
        - AlarmType

    UserAttributeType:
      type: object
      properties:
        AttributeID:
          type: string
        Description:
          type: array
          items: 
            type: string
        Value:
          type: array
          items:
            $ref: './CommonTypes.yaml#/components/schemas/ValueType'

    PersonnelIdentificationManifestType:
      type: object
      properties:
        EntryID:
          type: string
          description: A unique identification of the BPR individual element.  
        ObjectType:
          $ref: '#/components/schemas/RecordObjectTypeType'
          description: Identifies the type of object an entry is based upon. 
        TimeStamp:
          type: string
          format: datetime
          description: The optional time stamp associated with the entry.
        ExternalReference:
          type: string
          description: Contains an optional reference to data which is stored external to the BPR.
        Description:
          type: array
          description: Additional optional additional information about the BPR.
          items:
            type: string
        RecordReference:
          type: string
        Name:
          type: array
          description: Defines the name of the person.
          items:
            type: string
        ChangeIndication:
          type: string
          description: 'An indication enabling detection that the PersonnelIdentificationManifest element has not been altered. Example: string generated by an MD5 hash algorithm of the name, record reference, and reason.'
        Reason:
          type: string
          description: Defines the reason for the signature. 
      required:
        - EntryID
        - ObjectType
        - ChangeIndication
        

    RecordObjectTypeType:
      oneOf:
        - $ref: '#/components/schemas/RecordObjectType1Type'
        - type: object
          properties:
            '$':
              $ref: '#/components/schemas/RecordObjectType1Type'
            '@OtherValue':
              type: string

    RecordObjectType1Type:
      type: string
      description: If “Other” then the type is an application specific extension and the value is defined in the attribute “OtherValue”.
      enum: ["Batch Production Record","Change","Comment","Control Recipe","Data Set","Event","Master Recipe","Personnel Identification Manifest","Resource Definition Manifest","Recipe Element","Sample","Sample Test","Sample Test Result","Work Directive","Work Master","Work Performance","Work Schedule","Other"]

    CommentType:
      type: object
      properties:
        EntryID:
          type: string
          description: A unique identification of the BPR individual element.  
        ObjectType:
          $ref: '#/components/schemas/RecordObjectTypeType'
          description: Identifies the type of object an entry is based upon. 
        TimeStamp:
          type: string
          format: datetime
          description: The optional time stamp associated with the entry.
        ExternalReference:
          type: string
          description: Contains an optional reference to data which is stored external to the BPR.
        Description:
          type: array
          description: Additional optional additional information about the BPR.
          items:
            type: string
        RecordReference:
          type: string
          description: The EntryID of a specific element in the BPR.
        CommentText:
          type: array
          description: The text comment
          items:
            type: string
        PersonID:
          type: string
          description: Defines the person associated with the comment. 
      required:
        - EntryID
        - ObjectType
        - RecordReference
  